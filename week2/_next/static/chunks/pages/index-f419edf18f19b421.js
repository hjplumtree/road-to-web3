(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3685:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(4569)}])},4569:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return g}});var r=t(4051),a=t.n(r),o=t(5893),i=JSON.parse('{"Mt":[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"},{"indexed":false,"internalType":"string","name":"name","type":"string"},{"indexed":false,"internalType":"string","name":"message","type":"string"}],"name":"NewMemo","type":"event"},{"inputs":[{"internalType":"string","name":"_name","type":"string"},{"internalType":"string","name":"_message","type":"string"}],"name":"buyBubbleTea","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"getMemos","outputs":[{"components":[{"internalType":"address","name":"from","type":"address"},{"internalType":"uint256","name":"timestamp","type":"uint256"},{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"message","type":"string"}],"internalType":"struct BuyMeABubbleTea.Memo[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"withdrawTips","outputs":[],"stateMutability":"nonpayable","type":"function"}]}'),s=t(6076),c=t(5553),u=t(715),l=t(9008),p=t(7294),m=t(1673),d=t.n(m);function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function h(e,n,t,r,a,o,i){try{var s=e[o](i),c=s.value}catch(u){return void t(u)}s.done?n(c):Promise.resolve(c).then(r,a)}function y(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var o=e.apply(n,t);function i(e){h(o,r,a,i,s,"next",e)}function s(e){h(o,r,a,i,s,"throw",e)}i(void 0)}))}}function b(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return f(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return f(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(){var e="0x133394e78B6C0cD2F6ea57FFfBf930768967f827",n=i.Mt,t=(0,p.useState)(""),r=t[0],m=t[1],f=(0,p.useState)(""),h=f[0],g=f[1],x=(0,p.useState)(""),v=x[0],_=x[1],w=(0,p.useState)([]),j=w[0],k=w[1],T=function(){var e=y(a().mark((function e(){var n,t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=window.ethereum,e.next=4,n.request({method:"eth_accounts"});case 4:t=e.sent,console.log("accounts: ",t),t.length>0?(r=t[0],console.log("wallet is connected! "+r)):console.log("make sure MetaMask is connected"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("error: ",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=y(a().mark((function e(){var n,t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(n=window.ethereum)||console.log("please install MetaMask"),e.next=5,n.request({method:"eth_requestAccounts"});case 5:t=e.sent,m(t[0]),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var t=y(a().mark((function t(r){var o,i,l,p,m;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(o=window.ethereum)){t.next=16;break}return i=new u.Q(o,"any"),l=i.getSigner(),p=new s.CH(e,n,l),console.log("buying bubble tea.."),t.next=9,p.buyBubbleTea(h||"Santa",v||"Enjoy your bubble tea!",{value:c.fi(r)});case 9:return m=t.sent,t.next=12,m.wait();case 12:console.log("mined ",m.hash),console.log("bubble tea purchased!"),g(""),_("");case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),console.log(t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e){return t.apply(this,arguments)}}(),S=function(){var t=y(a().mark((function t(){var r,o,i,c,l;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(r=window.ethereum)){t.next=14;break}return o=new u.Q(r),i=o.getSigner(),c=new s.CH(e,n,i),console.log("fetching memos from the blockchain.."),t.next=9,c.getMemos();case 9:l=t.sent,console.log("fetched!"),k(l),t.next=15;break;case 14:console.log("Metamask is not connected");case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(){return t.apply(this,arguments)}}();return(0,p.useEffect)((function(){var t;T(),S();var r=function(e,n,t,r){console.log("Memo received: ",e,n,t,r),k((function(a){return b(a).concat([{address:e,timestamp:new Date(1e3*n),message:r,name:t}])}))},a=window.ethereum;if(a){var o=new u.Q(a,"any").getSigner();(t=new s.CH(e,n,o)).on("NewMemo",r)}return function(){t&&t.off("NewMemo",r)}}),[]),(0,o.jsxs)("div",{className:d().container,children:[(0,o.jsxs)(l.default,{children:[(0,o.jsx)("title",{children:"Buy HeJ a Bubble Tea!"}),(0,o.jsx)("meta",{name:"description",content:"Tipping site"}),(0,o.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,o.jsxs)("main",{className:d().main,children:[(0,o.jsx)("h1",{className:d().title,children:"Buy HeJ a Bubble Tea!"}),r?(0,o.jsx)("div",{children:(0,o.jsxs)("form",{className:d().formContainer,children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{children:"Name"}),(0,o.jsx)("br",{}),(0,o.jsx)("input",{id:"name",type:"text",placeholder:"Santa",value:h,onChange:function(e){g(e.target.value)}})]}),(0,o.jsx)("br",{}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{children:"Send HeJ a message"}),(0,o.jsx)("br",{}),(0,o.jsx)("textarea",{rows:3,placeholder:"Enjoy your bubble tea!",id:"message",value:v,onChange:function(e){_(e.target.value)},required:!0})]}),(0,o.jsxs)("div",{className:d().buttonContainer,children:[(0,o.jsx)("button",{type:"button",onClick:function(){return C("0.001")},children:"Send 1 Bubble Tea for 0.001ETH"}),(0,o.jsx)("button",{type:"button",onClick:function(){return C("0.003")},children:"Send 1 Large Bubble Tea for 0.003ETH"})]})]})}):(0,o.jsx)("button",{onClick:M,children:" Connect your wallet "})]}),r&&(0,o.jsx)("h1",{children:"Memos received"}),r&&j.map((function(e,n){return(0,o.jsxs)("div",{style:{border:"2px solid",borderRadius:"5px",padding:"5px",margin:"5px"},children:[(0,o.jsxs)("p",{style:{fontWeight:"bold"},children:['"',e.message,'"']}),(0,o.jsxs)("p",{children:["From: ",e.name," at ",e.timestamp.toString()]})]},n)})),(0,o.jsx)("footer",{className:d().footer,children:(0,o.jsx)("a",{href:"https://alchemy.com/?a=roadtoweb3weektwo",target:"_blank",rel:"noopener noreferrer",children:"Created by @hjplumtree for Alchemy's Road to Web3 lesson two!"})})]})}},1673:function(e){e.exports={container:"Home_container__97eC3",main:"Home_main__OVLM4",footer:"Home_footer__zed0_",title:"Home_title__q0Qg4",description:"Home_description__JhekB",code:"Home_code__2i1pD",grid:"Home_grid__npx0i",card:"Home_card__K7aTN",logo:"Home_logo__FLQOc",formContainer:"Home_formContainer__jS_dQ",buttonContainer:"Home_buttonContainer__wSNkk"}},6601:function(){}},function(e){e.O(0,[609,774,888,179],(function(){return n=3685,e(e.s=n);var n}));var n=e.O();_N_E=n}]);